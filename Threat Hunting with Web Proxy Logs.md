Web Proxies generate a common set of information such as duration, http status, bytes in, bytes out, protocol, http method, http version, url category, url hostname, url path, url query, mime type, file name, user-agent

## Duration

- Shows how long the transaction has taken.
- Useful for detecting malware C2 communication

**Technique**
- Calculate the sum per SourceIP - DestinationIP pair over 12/24 hrs


----------------------------------------------------------------------

## HTTP Status 

- Generated by users visiting sites, making posts, uploading data and/or download a file. This would normally generate an HTTP 200 code
- HTTP error codes may be used as a C2 channel.
- Most malware use domain generation algorithm to estasblish persistence if one of the domains is blocked. This results in the malware receiving HTTP errors and tries the next domain

**Technique**

- Calculate the total count of the HTTP status codes per SourceIP or per Source IP - Destination IP over a specific time period
- List URLs that have only HTTP errors

**What to look for: Indications of C2**
- Higher values of an uncommon HTTP status codS
- Higher values of HTTP errors for a website
----------------------------------------------------------------------


## Bytes In

- Each transaction - visiting a website, downloading a file - results in a different size of data. 
- When malware visits the same page repeatedly, the downloaded content has the same size unless the attackers start interacting with the victim machine

**Technique**

- Calculate the Bytes in per source/destination pair over 12/24 hrs. 
- Calculate the ratio of count (bytes in) per src/dest pair. This compares the attacker interaction versis idle status

**What to look for**

- higher values of ratio
- C2 servers reply with the same data, making bytes in value the same

----------------------------------------------------------------------


## Bytes Out

Normal user activity consists mostly of downloading data. Uploaded data is usually small unless there is a file/data upload to a website.

**Technique**

- Calculate the sum of Bytes out per src/dest pair over 12/24 hrs
- Calculate the ratio of count (bytes out) per src/dest pair over 12/24 hrs

**What to look for**
- Higher values may indicate exfiltration
- Higher values of raito may indicate beaconing

----------------------------------------------------------------------


## HTTP Method

A users web traffic contains a large amount of HTTP GET, a small amount of HTTP POST methods. Other HTTP methods, such as HTTP PUT, are expected to be seen less.

**Technique**

- Calculate the ratio of the POST or PUT over GET per src/dest over 4/8/12/24 hrs

- High ratio values may indicate beaconing or exfiltration

----------------------------------------------------------------------



## URL Hostname

Usually a user vists websites in the 1M list. In some cases, an unpopular website can be visited by lots of users as well.

**Technique**
- Compare with top 1M domains and calculate the hit count.
- Calculate hit count per hostname

**What to look for**
- Hit count < 5 and hostname are not in the top 1M may indicate malicious payload delivery.
- Small number of hit count may indicate malicious payload delivery


----------------------------------------------------------------------


## URL Path

When an attacker compromises a website and uses it as a C2 server, the malware most probably uses the same URL path for C2 comms

****

----------------------------------------------------------------------


## 

****

----------------------------------------------------------------------


## 

****

----------------------------------------------------------------------
